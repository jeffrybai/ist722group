version: 2

models:
  - name: fact_sales
    description: Order level fact table. Transaction one row per book/store/ordernumber
    columns:
      - name: order_number
        description: surrogate concat order_num, title_id, store_id
        tests:
          - not_null
          - unique
      - name: titles_key
        description: Dimension key for dim_titles
        tests:
          - not_null
      - name: publishers_key
        description: Dimension key for dim_publishers
        tests:
          - not_null
      - name: stores_key
        description: Dimension key for dim_stores
        tests:
          - not_null
      - name: orderdate_key
        description: Dimension key for dim_date
        tests:
          - not_null
      - name: order_year
        description: Year of order
        tests:
          - not_null
      - name: order_num
        description: order number (degenerate dimension)
      - name: title_id
        description: titleid (degenerate dimension)
      - name: pub_id
        description: pubid (degenerate dimension)
      - name: stor_id
        description: store id (degenerate dimension)
      - name: title_title
        description: book title
      - name: title_category
        description: book category
      - name: title_price
        data_type: money
        description: price per book (degenerate dimension)
        tests:
          - not_null
      - name: quantity
        description: quantity ordered
      - name: extended_price_amount
        data_type: money
        description: additive fact for quantity * title_price 
        tests:
          - not_null
      - name: store_discounttype
        data_type: char
        description: degenerate dimension
        tests:
          - not_null
      - name: high_volume_dicount
        data_type: char
        description: degenerate dimension
      - name: initial_order_discount
        data_type: char
        description: degenerate dimension
        tests:
          - not_null
      - name: total_discount_percentage
        data_type: decimal
        description: additive fact of all qualified discount percentages per order
      - name: orders
        data_type: int
        description: additive fact for order of books
        tests:
          - not_null
      - name: customer_discount
        data_type: int
        description: Boolean Order qualify for customer discount 1 yes 0 no
        tests:
          - not_null 
      - name: volume_discount
        data_type: int
        description: Boolean Order qualify for volume discount 1 yes 0 no
        tests:
          - not_null
      - name: initial_customer_discount
        data_type: int
        description: Boolean Order qualify for initial customer discount 1 yes 0 no
        tests:
          - not_null
      - name: total_discount_percentage
        data_type: decimal
        description: additive fact of all qualified discount percentages per oder
        tests:
          - not_null
      - name: customer_discount_amount
        data_type: money
        description: fact (d.discount/100) * extended_price_amount
        tests:
          - not_null
      - name: volume_discount_amount
        data_type: money
        description: fact (volume discount/100) * extended_price_amount
        tests:
          - not_null
      - name: initial_customer_discount_amount
        data_type: money
        description: fact (initial customer discount/100) * extended_price_amount
        tests:
          - not_null
      - name: total_discount_amount
        data_type: money
        description: additive fact all discount amounts per order
        tests:
          - not_null
      - name: net_sales_amount
        data_type: money
        description: fact extended price- discount amount
        tests: 
          - not_null
      - name: total_royalty_amount
        data_type: money
        description: royalty/100
